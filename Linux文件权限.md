## Linux文件权限 ##

```
Linux系统的核心是用户账号，每个登录系统的用户都有一个uid和一个用户名
```
### /etc/passwd文件 ###
```
这个文件包含了与用户有关的信息，里面可以看到很多的账户，Linux为每一个功能创建一个账户，但是这个不是真实的账户，这个叫系统账户，是特定的访问特定资源的账户，这个文件中包括了七个字段，用:分隔开来，依次是:
用户名：密码：uid:gid:备注：家目录：默认shell
但是这个文件中的密码字段都是一个x，真正的密码文件在/etc/shadow
```
### /etc/shadow ###
```
这里保存了加密的密码，只有root才能够访问
```
### 添加新用户 ###
```
useradd 使用系统的默认值以及命令行参数来设置用户账户，系统的默认值在/etc/default/useradd文件中，我们可以通过useradd -D查看系统的默认值
默认值有：组id为100的公共组
home目录为/home/登录名
同时系统会将/etc/skel目录下的内容复制到用户的home目录下
notice：
我们可以在/etc/skel里面创建一个模板，这样子会创建的每个用户会将里面的东西复制进去。
useradd 的命令行参数
```
![useradd命令参数](http://60.205.205.242/imgs/QQ截图20180425105208.png)
![useradd命令参数](http://60.205.205.242/imgs/QQ截图20180425105420.png)
```
如果一个值经常需要设定的话，我们可以修改默认值，通过命令修改默认值 useradd -D 参数
```
![修改默认值](http://60.205.205.242/imgs/QQ截图20180425105659.png)
### 删除用户 ###
```
userdel 用户名 默认情况只会删除/etc/passwd文件里面的用户信息
userdel -r 用户名 会删除home目录，但是还可能存在这个用户的一些文件
```
### 修改用户 ###
```
命令如下：
```
![修改用户账户的相关的信息](http://60.205.205.242/imgs/QQ截图20180425112824.png)
#### usermod ####
```
usermod 可以修改/etc/passwd文件中的大部分字段，参数跟useradd的大部分是一样的，此外还有一些常用的参数
usermod -l 修改登录名
usermod -L 锁定某个用户
usermod -U 解除锁定
usermod -p 修改密码(注意这个修改后在/etc/shadow里面是明文保存的)
```
#### passwd 和chpasswd ####
```
passwd 用户名 就可以设置密码
chpasswd < text.txt 
里面的格式为 用户名:密码
```
#### chsh chfn 和chage ####
```
finger用于查看用户的信息
chfn可以修改相应的字段
chage用来管理用户的有效期
```
![用户有效期的参数](http://60.205.205.242/imgs/QQ截图20180425134053.png)
### 使用Linux用户组 ###
#### /etc/group ###
```
组信息保存在这个文件中，这个文件也是分为四个字段的，每个字段用：分隔，依次是 组名：组密码：gid：属于该组的用户列表
notice：
在/etc/passwd中指定的默认组 在这个文件中的用户列表里面用户是不会出现的
```
#### 创建新租 ####
```
groupadd 组名
usermod -G 组名 用户名
usermod -g 会替换到默认组
```
#### 修改组 ####
```
groupmod -n 现在组名 原组名
```
### 理解文件权限 ###
```
在ls -l中列出的第一部分指明了文件的权限，如
-rwxrwxrwx
第一个-代表是一个文件
- \-文件
- c字符设置
- b块设备
- n网络设备
- d是目录
接下来的三个代表的属主的读写和执行权限
在接下来的三个是所在组的
最好三个是其他用户
在我们创建一个文件的时候会有默认的权限，这个默认的权限我们可以通过umask来显示和设置
每个用户的权限我们用一个8进制数来表示，将八进制转为二进制对应的位为1代表有相应的权限如：
6 110 代表的是读写没有执行权限
umask是用来屏蔽某些权限的例如默认为0022，000 010 010 就是去掉写权限
默认创建的文件的权限为666-022=644 而文件夹为777-022=755
```
### 改变安全性设置 ###
#### 改变权限 ####
```
chmod [options] mode file
chmod 777 file
使用rwx设置
chmod o+x file 为file的其他用户添加x
```
#### 改变所属关系 ####
```
chown 改变所属主=》chown 所属主 file
chgrp 改变文件的默认属主=>chgrp 所属组 file
同时更改二者 chown 所属主.所属组 file
-R 可以递归的更改所有的文件的权限
-h 可以更改所有连接到此文件的权限
```
#### 共享文件 ####
```
sgid是文件和文件夹存储的额外的信息，当我们将一个文件夹设置sgid位置位时，在这个文件夹下边创建的文件具有和这个文件夹相应的属性
tips：
我们创建一个test目录，并且设置所属组为shared，我们将这个文件夹的组的sgid置位，那么在这个文件夹下创建的文件具有相同的属性
mkdir test
chgrp shared test
chmod g+stest
cd test
touch aa.txt 
ls -l aa.txt 查看所属组即可看到
```